# 타입스크립트 프로그래밍

**Why use?**

- 타입스크립트는 코드를 자동으로 검사하여 개발자가 놓칠 수 있는 실수를 지적해준다.
- 프로그램의 충돌을 줄이고 더 좋은 코드 문서화를 제공하며, 다양한 사용자, 개발자, 서버가 응용 프로그램을 이용할 수 있도록 확장성을 확보하는 방법 제공한다
- 실용성 - 간결하고 정확하게 원하는 바를 표현 할 수 있다.

&nbsp;

**Code style**

- 명시적 타입을 남용하지 않는다. 그래야 코드가 깨끗하고, 간결하며, 잘못된 타입을 대충 넘기지 않고 검출되도록 하여 안정성을 개선할 수 있기 때문이다.
- 재사용할 수 있는 범용 코드를 만들려 노력한다. (다형성)

&nbsp;

## 1. 소개

---

- **타입 안전성(type-safety)** - 타입을 이용해 프로그램이 **유효하지 않은 작업을 수행하지 않도록 방지**한다 (ex. 숫자와 리스트 곱하기).
- 자바스크립트에서는 코드에 실수를 저지른 시점과 그 실수를 처음 인지하는 시점이 달라지기 쉽다. 즉, 프로그램을 실행해봐야 실수를 인지 할 수 있다.
- 타입스크립트를 사용하면 **코드 편집기에 코드를 입력하는 순간** (유효하지 않은 코드를 대상으로) 곧바로 에러 메시지를 발생시킨다.

&nbsp;

자바스크립트는 아래와 같은 코드에 대해 예외를 던지지 않고, 최선을 다해 결과를 도출한다.

```javascript
3 + []; // 문자열 "3"으로 평가

let obj = {};
obj.foo; // undefined로 평가

function a(b) {
  return b / 2;
}
a('z'); // NaN으로 평가
```

때문에 자바스크립트에서는 코드에 실수를 저지른 시점과 그 실수를 처음 인지하는 시점이 달라지기 쉽다. 즉, 프로그램을 실행해봐야 실수를 인지 할 수 있다.

타입스크립트를 사용하면 **코드 편집기에 코드를 입력하는 순간** 곧바로 에러 메시지를 발생시킨다. 위 예제를 타입스크립트를 사용하여 작성하면 아래와 같은 결과를 확인 할 수 있다.

```typescript
3 + []; // 에러: '3' 타입과 'never[]' 타입에 연산자 '+'를 적용할 수 없음

let obj = {};
obj.foo; // '{}' 타입에 'foo' 프로퍼티가 존재하지 않음

function a(b) {
  return b / 2;
}
a('z'); // number 타입의 매개변수에 'z'라는 인수 타입을 할당할 수 없음
```

모든 타입 관련 버그가 사라질 뿐 아니라, 코드를 작성하는 방식도 달라진다. 프로그램을 설계하며 극단적인 상황을 먼저 고려하게 되며 더 간단하고, 빠르고, 이해하기 쉬우며, 유지하기 쉬운 프로그램을 설계할 수 있다.

&nbsp;

## 2. 타입스크립트 Overview

---

### 2.1. 컴파일러

- 타입 검사기 - 코드의 타입 안전성을 검증하는 특별한 프로그램

&nbsp;

**일반적인 컴파일러의 동작 순서 (Node, 브라우저 환경에서의) **

1. 프로그램(코드)를 AST로 파싱
2. AST가 바이트코드로 컴파일
3. 런타임이 바이트코드를 평가

&nbsp;

**TSC의 동작 순서**

1. 타입스크립트 소스 -> 타입스크립트 AST
2. 타입 검사기(typechecker)가 AST를 확인
   1. 타입 확인 과정을 거쳐 프로그램이 개발자의 기대대로 실행 될 수 있도록 해주고, 명백한 실수가 들어가지 않게 방지
3. 타입스크립트 AST -> 자바스크립트 소스
   1. 타입스크립트 컴파일러는 코드를 바이트코드 대신 자바스크립트 코드로 변환한다.
   2. 이 과정에서 개발자가 사용한 타입을 확인하지 않는다. **개발자가 코드에 기입한 타입 정보는 최종적으로 만들어지는 프로그램에 아무런 영향을 주지 않으며, 단지 타입을 확인하는 데만 쓰인다.**
4. 일반적인 컴파일러의 동작 순서를 이어서 진행

&nbsp;

> **컴파일러와 런타임**
>
> 보통 자바스크립트 컴파일러와 런타임은 엔진이라는 하나의 프로그램으로 합쳐진다. V8(NodeJS, 크롬 등), 스파이더몽키(FireFox), JSCore(사파리), 샤크라(엣지) 등 여러 엔진의 종류가 있으며, 자바스크립트가 해석되는(interpreted) 언어의 모습을 갖게 만든다.

&nbsp;

### 2.2. 타입 시스템

- 타입 시스템 - 타입 검사기가 프로그램에 타입을 할당하는 데 사용하는 **규칙 집합**
  - 명시적 타입 시스템(타입 어노테이션 사용)
  - 타입 추론

&nbsp;

타입 어노테이션을 사용하여 명시적으로 타입을 정할 수 있다.

```typescript
let a: number = 1; // a는 number
let b: string = 'hello'; // b는 string
let c: boolean[] = [true, false]; // c는 boolean 배열
```

반대로 타입스크립트가 타입을 추론하도록 코드를 작성 할 수 있다.

```typescript
let a = 1; // a는 number
let b = 'hello'; // b는 string
let c = [true, false]; // c는 boolean 배열
```

타입스크립트가 타입을 추론하도록 두는 것이 코드를 줄일 수 있는 방법이므로, 보통 어노테이션은 생략한다.

&nbsp;

#### 2.2.1 타입스크립트 vs. 자바스크립트

| 타입 시스템 기능            | 자바스크립트   | 타입스크립트        |
| --------------------------- | -------------- | ------------------- |
| 타입 결정 방식              | 동적           | 정적                |
| 타입이 자동으로 변환되는가? | O              | X(대부분)           |
| 언제 타입을 확인하는가?     | 런타임         | 컴파일 타임         |
| 언제 에러를 검출하는가?     | 런타임(대부분) | 컴파일 타임(대부분) |

&nbsp;

**타입은 어떻게 결정되는가?**

- 자바스크립트는 프로그램을 실행하기 전에는 타입을 알 수 없다. (동적 타입 바인딩)
- 타입스크립트는 점진적으로 타입을 확인하는(**gradually typed**) 언어이다.
  - 컴파일 타임에 프로그램의 모든 타입을 알아야 하는 것은 아니다. (자바스크립트 코드를 타입스크립트로 마이그레이션할 때 유용하다.)
  - 단, 프로그램의 모든 타입을 알고 있을 때 최상의 결과를 보여줄 수 있다.

&nbsp;

**자동으로 타입이 변환되는가?**

- 자바스크립트는 약한 타입(weakly typed) 언어다. 즉, 유요하지 않은 연산(ex. 숫자와 리스트 더하기)을 수행하면 다양한 규칙을 적용해가며 최상의 결과를 도출한다.
  - 암묵적 형변환으로 인해 문제의 원인을 추적하기 어렵다.
- 타입스크립트는 올바르지 않아 보이는 작업을 발견하는 즉시 불평한다. 의도를 명시해야 이러한 지적을 무사히 통과할 수 있다.

&nbsp;

**언제 타입을 검사하는가?**

- 자바스크립트는 대부분의 상황에서 타입이 무엇인지 따지지 않는다.
- 타입스크립트는 정적으로 코드를 분석해 이런 에러를 검출하여 코드를 실행하기도 전에 알려준다.

&nbsp;

**에러는 언제 검출되는가?**

- 자바스크립트는 프로그램을 실행해야만 어떤 문제가 있음을 확인할 수 있다.
- 타입스크립트는 컴파일 타임에 문법 에러와 타입 관련 에러를 모두 검출한다.
  - 단, 스택오버플로, 네트워크 연결 끊김, 잘못된 사용자 입력 등 컴파일 타임에 검출 할 수 없는 런타임 예외도 많다.

&nbsp;

### 2.3. 코드 편집기 설정

- 모든 타입스크립트 프로젝트는 루트 디렉터리에 tsconfig.json 파일이 존재해야한다.
- tsconfig.json 파일은 타입스크립트의 프로젝트에서 어떤 파일을 컴파일하고, 어떤 자바스크립트 버전으로 방출하는지 등을 정의한다.

```json
// tsconfig.json
{
  "compilerOptions": {
    "lib": ["es2015"], // TSC가 코드 실행 환경에서 이용할 수 있다고 가정하는 API
    "module": "commonjs", // TSC가 코드를 컴파일할 대상 모듈 시스템
    "outDir": "dist", // 생성된 자바스크립트 코드를 출력할 디렉터리
    "sourceMap": true,
    "strict": true, // 유효하지 않은 코드를 검사할 때 엄격하게 검사 (코드가 타입을 갖추도록 강제)
    "target": "es2015" // TSC가 코드를 컴파일할 자바스크립트 버전
  },
  "include": ["src"] // TSC가 타입스크립트 파일을 찾을 디렉터리
}
```

&nbsp;
